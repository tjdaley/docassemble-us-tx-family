---
modules:
  - docassemble.base.legal
  - docassemble.us_tx_family.functions
---
include:
  - docassemble.us_tx_family:all_docs.yml
---
mandatory: True
code: |
  if 'allow_add_case' not in locals():
    allow_add_case = False
---
section: case
decoration: balance-scale
question: |
  Select a case
  % if allow_add_case:
    or add a new one.
  % endif
fields:
  - Case: case_key
    code: |
      my_cases(allow_add=allow_case_add)
---
mandatory: True
code: |
  case_key
  if case_key != '*ADD*':
    case = get_case(case_key)
  if case == '*NONE*':
    case = Case()
  doc.case = case
---
mandatory: True
code: |
  case.case_id
  save_case(case)
  is_saved = "TRUE"
---