---
metadata:
  description: |
    Include this file to prompt the user to select a case.
    If you want the user to be able to add a case (you should not want that)
    then you must include all_add_case_true.yml BEFORE you include this file.
  authors:
    - name: Thomas J. Daley, J.D.
      organization: Power Daley PLLC
  revision_date: 2020-02-08
---
modules:
  - docassemble.base.legal
  - docassemble.base.functions
  - docassemble.us_tx_family.functions
---
include:
  - docassemble.us_tx_family:all_docs.yml
---
sets: allow_case_add
code: |
  # The default is to OMIT the "(ADD NEW CASE)" option.
  # See description above for instructions to override this behavior.
  if not defined('allow_case_add'):
    define('allow_case_add', False)
---
section: case
decoration: balance-scale
question: |
  Select a case
  % if allow_case_add:
    or add a new one.
  % endif
fields:
  - Case: case_key
    code: |
      my_cases(allow_add=allow_case_add)
---
mandatory: True
code: |
  case_key
  if case_key != '*ADD*':
    case = get_case(case_key)
  if case == '*NONE*':
    case = Case()
  doc.case = case
---
mandatory: True
code: |
  case.case_id
  save_case(case)
  is_saved = "TRUE"
---